# 07. 迭代计划与待确认问题

## 迭代里程碑（建议）

1. **需求对齐**：确认 Chat API、工具清单、数据模型与安全边界
2. **可编译可启动**：补齐缺失类、基础健康检查通过
3. **前端 UI MVP**：HTML + JS + CSS（无复杂构建链），支持对话、流式输出与图表渲染
4. **MCP 工具落地**：Mongo/Neo4j/ECharts/WebSearch 的最小可用实现 + 单测
5. **问答编排**：LLM 工具调用闭环（tool call -> tool result -> final answer），支持 SSE
6. **可靠性**：日志/追踪、限流、错误恢复、配置化开关

## MVP 验收用例（建议）

0. **Web UI 可用**：打开 `GET /`，能发送消息、看到流式输出（SSE），并能渲染返回的 ECharts 图表（你提供的 JS 包会放入 `static/vendor/`）。
1. **数据库存储**：对话中要求“记住这条信息”，模型调用 `mongo_save_document`，返回 `id`，并能在后续对话中查回。
2. **数据库检索**：用户问“上次我说的 xxx 是什么？”，模型调用 `mongo_find_by_topic` 或 `mongo_find_by_id`，并在回答中引用检索结果。
3. **联网搜索**：用户问“今天/最近发生的某事”，模型调用 `web_search`，返回 3~5 条结果并在回答中列出来源链接。
4. **图表生成**：用户问“把这些数据画成折线图”，模型调用 `echart_generate`，返回可直接渲染的 ECharts `option`。

## 待确认问题（请你补充偏好）

1. **LLM 选择**：以智谱为主，还是本地 Ollama 为主？是否需要可插拔？
2. **“数据库检索/存储”具体对象**：主要存对话？还是存结构化知识库（实体关系/文档）？
3. **联网搜索结果如何使用**：仅用于回答，还是要落库（Mongo/Neo4j）形成长期知识？
4. **图表生成的输入来源**：由模型在回答时抽取数据？还是前端/业务侧直接提供结构化数据？
5. **安全策略**：是否需要对 DB 写入设置白名单（集合/标签/字段）与审批？
